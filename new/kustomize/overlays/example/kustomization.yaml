apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: sourcegraph-kustomize-example
resources:
  # Sourcegraph Main Stacks
  - ../../../resources/sourcegraph
  # Sourcegraph Monitoring Stacks
  - ../../../resources/monitoring

# Add components here
components:
  - ../../components/StorageClass/aws          # Create a StorageClass resource for aws

# Update replica number here
replicas:
  - name: sourcegraph-frontend
    count: 3
  - name: searcher
    count: 2
  - name: symbols
    count: 2
  # IMPORTANT: You must add the 'sourcegraph-replicas.yaml' file under the 'replacements' field
  # when update gitserver replica number 
  - name: gitserver
    count: 5

replacements:
  # IMPORTANT: Required when changing replica numbers for gitserver
  - path: sourcegraph-replicas.yaml
